
\documentclass[a4paper,UKenglish,cleveref, autoref, thm-restate]{lipics-v2021}
%This is a template for producing LIPIcs articles.
%See lipics-v2021-authors-guidelines.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling autoref support, use "autoref"
%for anonymousing the authors (e.g. for double-blind review), add "anonymous"
%for enabling thm-restate support, use "thm-restate"
%for enabling a two-column layout for the author/affilation part (only applicable for > 6 authors), use "authorcolumns"
%for producing a PDF according the PDF/A standard, add "pdfa"

%\pdfoutput=1 %uncomment to ensure pdflatex processing (mandatatory e.g. to submit to arXiv)
%\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

\title{Determinism of ledger updates} %TODO Please add

%\titlerunning{Dummy short title} %TODO optional, please use if title is longer than one line

\author{James	Chapman}{IOHK} {james.chapman@iohk.io}{}{}

\author{Andre	Knispel}{IOHK} {andre.knispel@iohk.io}{}{}

\author{Orestis	Melkonian}{IOHK \and University of Edinburgh, UK} {orestis.melkonian@ed.ac.uk}{}{}

\author{Polina	Vinogradova}{IOHK} {polina.vinogradova@iohk.io}{}{}

%
% \author{Jane {Open Access}}{Dummy University Computing Laboratory, [optional: Address], Country \and My second affiliation, Country \and \url{http://www.myhomepage.edu} }{johnqpublic@dummyuni.org}{https://orcid.org/0000-0002-1825-0097}{(Optional) author-specific funding acknowledgements}%TODO mandatory, please use full name; only 1 author per \author macro; first two parameters are mandatory, other parameters can be empty. Please provide at least the name of the affiliation and the country. The full address is optional. Use additional curly braces to indicate the correct name splitting when the last name consists of multiple name parts.

\authorrunning{J.	Chapman and A.	Knispel and O.	Melkonian and P.	Vinogradova}
 %TODO mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{James	Chapman and Andre	Knispel and Orestis	Melkonian and Polina	Vinogradova}
%TODO mandatory, please use full first names. LIPIcs license is "CC-BY";  http://creativecommons.org/licenses/by/3.0/
% Polina	Vinogradova	polina.vinogradova@iohk.io	Canada	IOHK		✔
% Orestis	Melkonian	orestis.melkonian@ed.ac.uk	United Kingdom	University of Edinburgh, IOHK		✔
% Andre	Knispel	andre.knispel@iohk.io	Germany	IOHK		✔
% James	Chapman	james.chapman@iohk.io	United Kingdom	IOHK

\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10003752.10003766</concept_id>
<concept_desc>Theory of computation~Formal languages and automata theory</concept_desc>
<concept_significance>500</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[100]{Theory of computation~Formal languages and automata theory}
%\ccsdesc[100]{\textcolor{red}{Replace ccsdesc macro with valid one}} %TODO mandatory: Please choose ACM 2012 classifications from https://dl.acm.org/ccs/ccs_flat.cfm

\keywords{determinism, ledger model, theory of changes} %TODO mandatory; please add comma-separated list of keywords

\category{extended abstract} %optional, e.g. invited paper

\relatedversion{} %optional, e.g. full version hosted on arXiv, HAL, or other respository/website
%\relatedversiondetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93]{Classification (e.g. Full Version, Extended Version, Previous Version}{URL to related version} %linktext and cite are optional

%\supplement{}%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...
%\supplementdetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93, subcategory={Description, Subcategory}, swhid={Software Heritage Identifier}]{General Classification (e.g. Software, Dataset, Model, ...)}{URL to related version} %linktext, cite, and subcategory are optional

%\funding{(Optional) general funding statement \dots}%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.



%\nolinenumbers %uncomment to disable line numbering



%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{John Q. Open and Joan R. Access}
\EventNoEds{2}
\EventLongTitle{42nd Conference on Very Important Topics (CVIT 2016)}
\EventShortTitle{CVIT 2016}
\EventAcronym{CVIT}
\EventYear{2016}
\EventDate{December 24--27, 2016}
\EventLocation{Little Whinging, United Kingdom}
\EventLogo{}
\SeriesVolume{42}
\ArticleNo{23}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGES %

%\usepackage{natbib}
\usepackage{url}

% *** MATHS PACKAGES ***
%
\usepackage{etoolbox}
\usepackage{tikz-qtree}

%\usepackage[cmex10]{amsmath}
%\usepackage{amssymb}
%\usepackage{stmaryrd}
%\usepackage{amsthm}

% \usepackage[margin=2.5cm]{geometry}
\usepackage{iohk}
\usepackage{microtype}
\usepackage{mathpazo} % nice fonts
%\usepackage{amsmath}
\usepackage{amssymb}
%\usepackage{amsthm}
\usepackage{latexsym}
\usepackage{mathtools}
\usepackage{stmaryrd}
\usepackage{extarrows}
\usepackage{slashed}
%\usepackage[unicode=true,pdftex,pdfa,colorlinks=true]{hyperref}
%\usepackage{xcolor}
%\usepackage[capitalise,noabbrev,nameinlink]{cleveref}
%\usepackage{float}

% *** ALIGNMENT PACKAGES ***
%
\usepackage{array}
%\usepackage{float}  %% Try to improve placement of figures.  Doesn't work well with subcaption package.
% \usepackage{subcaption}
\usepackage{caption}

% \usepackage{subfiles}
% \usepackage{geometry}
% \usepackage{listings}
% % \usepackage[dvipsnames]{xcolor}
% \usepackage{verbatim}
% \usepackage{listings}% http://ctan.org/pkg/listings
% \lstset{
%   basicstyle=\ttfamily,
%   mathescape
% }
% \usepackage{alltt}
% \usepackage{paralist}

\usepackage{todonotes}

% COMMANDS %


\newcommand{\code}{\texttt}
\renewcommand{\i}{\textit}  % Just to speed up typing: replace these in the final version
\renewcommand{\t}{\texttt}  % Just to speed up typing: replace these in the final version
\newcommand{\s}{\textsf}  % Just to speed up typing: replace these in the final version
\newcommand{\msf}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\mi}[1]{\ensuremath{\mathit{#1}}}

%% A figure with rules above and below.
\newcommand\rfskip{3pt}
%\newenvironment{ruledfigure}[1]{\begin{figure}[#1]\hrule\vspace{\rfskip}}{\vspace{\rfskip}\hrule\end{figure}}
\newenvironment{ruledfigure}[1]{\begin{figure}[#1]}{\end{figure}}

%% Various text macros
\newcommand{\true}{\textsf{true}}
\newcommand{\false}{\textsf{false}}

\newcommand{\hash}[1]{\ensuremath{#1^{\#}}}

\newcommand\mapsTo{\ensuremath{\mapsto}}
\newcommand\cL{\ensuremath{\{}}
\newcommand\cR{\ensuremath{\}}}

\newcommand{\List}[1]{\ensuremath{\s{List}[#1]}}
\newcommand{\Set}[1]{\ensuremath{\s{Set}[#1]}}
\newcommand{\FinSet}[1]{\ensuremath{\s{FinSet}[#1]}}
\newcommand{\Interval}[1]{\ensuremath{\s{Interval}[#1]}}
\newcommand{\FinSup}[2]{\ensuremath{\s{FinSup}[#1,\linebreak[0]#2]}}
% ^ \linebeak is to avoid a bad line break when we talk about finite
% maps.  We may be able to remove it in the final version.
\newcommand{\supp}{\msf{supp}}

\newcommand{\Script}{\ensuremath{\s{Script}}}
\newcommand{\scriptAddr}{\msf{scriptAddr}}
\newcommand{\ctx}{\ensuremath{\s{Context}}}
\newcommand{\vlctx}{\ensuremath{\s{ValidatorContext}}}
\newcommand{\mpsctx}{\ensuremath{\s{PolicyContext}}}
\newcommand{\toData}{\ensuremath{\s{toData}}}
\newcommand{\toTxData}{\ensuremath{\s{toTxData}}}
\newcommand{\fromData}{\msf{fromData}}

\newcommand{\emptymap}{\ensuremath{\{\}}}
\newcommand{\verify}{\msf{verify}}

\newcommand{\mkContext}{\ensuremath{\s{mkContext}}}
\newcommand{\mkVlContext}{\ensuremath{\s{mkValidatorContext}}}
\newcommand{\mkMpsContext}{\ensuremath{\s{mkPolicyContext}}}
\newcommand{\checkSig}{\ensuremath{\s{checkSig}}}

\newcommand{\applyScript}[1]{\ensuremath{\llbracket#1\rrbracket}}
\newcommand{\applyMPScript}[1]{\ensuremath{\llbracket#1\rrbracket}}

% Macros for eutxo things.
\newcommand{\tx}{\mi{tx}}
\newcommand{\TxId}{\ensuremath{\s{TxId}}}
\newcommand{\txId}{\msf{txId}}
\newcommand{\txrefid}{\mi{id}}
\newcommand{\Address}{\ensuremath{\s{Address}}}
\newcommand{\DataHash}{\ensuremath{\s{DataHash}}}
\newcommand{\hashData}{\msf{dataHash}}
\newcommand{\idx}{\mi{index}}
\newcommand{\inputs}{\mi{inputs}}
\newcommand{\outputs}{\mi{outputs}}
\newcommand{\validityInterval}{\mi{validityInterval}}
\newcommand{\scripts}{\mi{scripts}}
\newcommand{\forge}{\mi{forge}}
\newcommand{\forgeScripts}{\mi{forgeScripts}}
\newcommand{\sigs}{\mi{sigs}}
\newcommand{\fee}{\mi{fee}}
\newcommand{\addr}{\mi{addr}}
\newcommand{\pubkey}{\mi{pubkey}}
\newcommand{\val}{\type{Value}}  %% \value is already defined

\newcommand{\validator}{\mi{validator}}
\newcommand{\redeemer}{\mi{redeemer}}
\newcommand{\datum}{\mi{datum}}
\newcommand{\datumHash}{\mi{datumHash}}
\newcommand{\datumWits}{\mi{datumWitnesses}}
\newcommand{\Data}{\ensuremath{\s{Data}}}
\newcommand{\Input}{\ensuremath{\s{Input}}}
\newcommand{\Output}{\ensuremath{\s{Output}}}
\newcommand{\OutputRef}{\ensuremath{\s{OutputRef}}}
\newcommand{\Signature}{\ensuremath{\s{Signature}}}
\newcommand{\Ledger}{\ensuremath{\s{Ledger}}}

\newcommand{\outputref}{\mi{outputRef}}
\newcommand{\outputrefs}{\mi{outputRefs}}
\newcommand{\txin}{\mi{in}}
\newcommand{\id}{\mi{id}}
\newcommand{\lookupTx}{\msf{lookupTx}}
\newcommand{\getSpent}{\msf{getSpentOutput}}

\newcommand{\Tick}{\ensuremath{\s{Tick}}}
\newcommand{\currentTick}{\msf{currentTick}}
\newcommand{\spent}{\msf{spentOutputs}}
\newcommand{\unspent}{\msf{unspentOutputs}}
\newcommand{\txunspent}{\msf{unspentTxOutputs}}
\newcommand{\eutxotx}{\msf{Tx}}


\newcommand{\consumes}[1]{\msf{consumes(#1)}}
\newcommand{\consumesOne}[1]{\msf{consumesOne(#1)}}
\newcommand{\cid}{\mi{cid}}
\newcommand{\inputValue}{\mi{inputValue}}
\newcommand{\rMin}{r_{\mi{min}}}
\newcommand{\rMax}{r_{\mi{max}}}

\newcommand{\utxotx}{\msf{Tx}}

\newcommand{\Quantity}{\ensuremath{\s{Quantity}}}
\newcommand{\Asset}{\ensuremath{\s{Asset}}}
\newcommand{\Policy}{\ensuremath{\s{PolicyID}}}
\newcommand{\Quantities}{\ensuremath{\s{Quantities}}}
\newcommand{\nativeCur}{\ensuremath{\mathrm{nativeC}}}
\newcommand{\nativeTok}{\ensuremath{\mathrm{nativeT}}}
\newcommand{\valC}{\mkValidator{\mathcal{C}}}
\newcommand{\polC}{\mkPolicy{\mathcal{C}}}
\newcommand\mkValidator[1]{\msf{validator}_#1}
\newcommand\mkPolicy[1]{\msf{policy}_#1}

\newcommand{\PublicKey}{\ensuremath{\s{PubKey}}}
\newcommand{\PrivateKey}{\ensuremath{\s{PrivateKey}}}

\newcommand{\pkey}{\ensuremath{\pi_{\mathsf{p}}}}
\newcommand{\skey}{\ensuremath{\pi_{\mathsf{s}}}}

\newcommand\B{\ensuremath{\mathbb{B}}}
\newcommand\N{\ensuremath{\mathbb{N}}}
\newcommand\Z{\ensuremath{\mathbb{Z}}}
\renewcommand\H{\ensuremath{\mathbb{H}}}
%% \H is usually the Hungarian double acute accent
\newcommand{\emptyBs}{\ensuremath{\emptyset}}
\newcommand{\leteq}{\ensuremath{\mathrel{\mathop:}=}}
\newcommand{\Nt}{\ensuremath{\Diamond}}
\newcommand{\Bool}{\type{Bool}}
\newcommand{\Type}{\type{Type}}
\newcommand{\Diff}{\type{Diff}}
\newcommand{\ValSt}{\type{ValSt}}

%ledger spec commands
\newcommand{\Request}{\type{Request}}
\newcommand{\LS}{\mathcal{L}\mathcal{S}}
\newcommand{\State}{\type{State}}
\newcommand{\AccState}{\type{AccState}}
\newcommand{\accid}{\type{AccID}}
\newcommand{\PCMT}{\type{PCMT}}
\newcommand{\Accts}{\type{Accts}}
\newcommand{\Open}{\type{Open}}
\newcommand{\OArgs}{\type{OArgs}}
\newcommand{\Close}{\type{Close}}
\newcommand{\CArgs}{\type{CArgs}}
\newcommand{\Deposit}{\type{Deposit}}
\newcommand{\DArgs}{\type{DArgs}}
\newcommand{\Withdraw}{\type{Withdraw}}
\newcommand{\WArgs}{\type{WArgs}}
\newcommand{\Transfer}{\type{Transfer}}
\newcommand{\TArgs}{\type{TArgs}}
\newcommand{\AccInput}{\type{AccInput}}
\newcommand{\Tx}{\type{Tx}}
\newcommand{\ID}{\type{ID}}
\newcommand{\Th}{\mathcal{T}}
\newcommand{\Tu}{\mathcal{U}}
\newcommand{\T}{\type{T}}
\newcommand{\Err}{\type{Err}}
\newcommand{\ups}{\fun{update}}
\newcommand{\FHBMT}{\type{FHBMT}}
\newcommand{\TxInfo}{\type{TxInfo}}

\newcommand{\True}{\type{True}}
\newcommand{\False}{\type{False}}


% For anonymisation
\newtoggle{anonymous}
\toggletrue{anonymous}
\iftoggle{anonymous}{
  \newcommand{\Cardano}{CHAIN}
  \newcommand{\Plutus}{LANG}
}{
  \newcommand{\Cardano}{Cardano}
  \newcommand{\Plutus}{Plutus Core}
}

% Names, for consistency
\newcommand{\UTXO}{UTXO}
\newcommand{\EUTXO}{E\UTXO{}}
\newcommand{\ExUTXO}{Extended \UTXO{}}
\newcommand{\CEM}{CEM}
\newcommand{\UTXOma}{\UTXO$_{\textrm{ma}}$}
\newcommand{\EUTXOma}{\EUTXO$_{\textrm{ma}}$}

\newcommand\initial{\msf{initial}}
\newcommand\nft{\blacklozenge}
\newcommand\step{\msf{step}}
\newcommand\satisfies{\msf{satisfies}}
\newcommand\checkOutputs{\msf{checkOutputs}}
\newcommand\txeq{tx^\equiv}

% relaxed float placement
\renewcommand{\topfraction}{.95}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\renewcommand{\dbltopfraction}{.66}
\renewcommand{\dblfloatpagefraction}{.66}
\setcounter{topnumber}{9}
\setcounter{bottomnumber}{9}
\setcounter{totalnumber}{20}
\setcounter{dbltopnumber}{9}

\newcommand\CStep[1]{\ensuremath{
 #1 \xrightarrow{\hspace{5pt} i \hspace{5pt}} (#1' , \txeq)
%%\textsf{step}\, #1\, i \equiv \textsf{just}\, #1'
}}

\begin{document}

\maketitle

%TODO mandatory: add short abstract of the document
\begin{abstract}
  Ensuring deterministic behaviour in distributed blockchain ledger design matters to
  end users because it allows for locally predictable fees, smart contract evaluation
  outcomes, and updates to other ledger-tracked data. In this work we begin by defining
  an abstract interface of ledgers and its update procedure, which gives us the ability
  to make formal comparisons of different ledger designs across various properties. We
  use this model as a basis for formalizing and studying several properties colloquially
  classified as determinism of ledgers.

  We identify a stronger and a weaker definition of determinism, providing simple but
  illustrative examples. We situate both versions of determinism in the context of the
  theory of changes, and conjecture what constraints on the derivation of ledger update
  functions are sufficient and necessary for the two definitions. We additionally discuss
  substates of a ledger state, which we refer to as threads, and outline how particular
  threads can remain deterministic while the full ledger may not be.

  We discuss how these ideas can be applied to realistic ledgers' designs and architectures,
  and analyze a nuanced example of non-determinism in an existing UTxO ledger with the
  tools we have developed.

\end{abstract}

\input{intro.tex}
\input{model-det.tex}
\input{discussion.tex}
%%
%% Bibliography
%%

%% Please use bibtex,

\bibliography{abstract-ledgers}

\appendix


\end{document}
